---
title: "Comparative Analysis"
author: "PS_2020_318-M.R.Surandi"
date: "2025-01-18"
output: html_document
---

```{r}
library(dplyr)
options(scipen = 999)

df<-read.csv("C:\\Users\\RISINA\\Desktop\\Concrete project\\socio-env-analysis\\Data_set.csv")
df

#Get the missing count and its proportion to the data set
missing_count<-vector()
mp<-vector()
for (i in 1:213) {
  missing_count[i] <- sum(is.na(df[i,5:68]))#counting missing values in each column
  mp[i]<-(missing_count[i]/64)*100
}

df$missing_proportion<-mp
df

#Find the mean of the each rows
avg<-vector()
for (i in 1:213) {
  avg[i] <- rowMeans(df[i,5:68], na.rm = TRUE)
}

df$Mean<-avg
df

df[,5:68][is.na(df[,5:68])] <- "na"
df


#Replace missing values with 'avg'(mean we have found)

for (i in 1:213) {
  for (j in 5:68) {
    if(df[i,j]=="na"){
      df[i,j]<-avg[i]
    }
  }
}
df

#filter the rows that have missing count less than to 70%
df1<-data.frame(df)
df1<-df[df$missing_proportion<=70 & df$Mean !=0,]
df1


```

